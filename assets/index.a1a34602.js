import{S as Q}from"./index.2ee5ae71.js";import{q as O,r as c,b as x,T as W,o as _,k as P,w as y,a as j,B as L,A as Z,I as ee,l as T,t as v,y as ne,x as V,S as te,c as C,F as M,j as R,m as se,n as U,z as ae,d as $,h as w}from"./vendor.ea41cd30.js";import{b as oe,e as re,a as le,f as ie}from"./components.c996eb06.js";import{_ as z}from"./elevation.7f6c0241.js";import{t as X,h as ce,g as de}from"./shared.2d2ec151.js";import{h as ue,b as ve,s as fe,n as _e,r as he}from"./elements.227b31a2.js";import{C as me}from"./index.67d1058a.js";import{u as pe,a as F,_ as xe,b as ye,c as Ce,w as be}from"./en-US.64d12132.js";import"./index.7850413d.js";const H=Symbol("INDEX_BAR_BIND_INDEX_ANCHOR_KEY"),Y=Symbol("INDEX_BAR_COUNT_INDEX_ANCHOR_KEY");function ke(){const{bindChildren:e,childProviders:a}=oe(H),{length:t}=re(Y);return{length:t,indexAnchors:a,bindIndexAnchors:e}}function Ie(){const{parentProvider:e,bindParent:a}=le(H),{index:t}=ie(Y);if(!e||!a)throw Error('[Varlet] IndexAnchor: You should use this component in "IndexBar"');return{index:t,indexBar:e,bindIndexBar:a}}const ge={index:{type:[Number,String]}};const Te=O({name:"VarIndexAnchor",components:{VarSticky:Q},inheritAttrs:!1,props:ge,setup(e){const{index:a,indexBar:t,bindIndexBar:l}=Ie(),i=c(0),d=c(!1),s=x(()=>e.index),o=c(null),{active:h,sticky:r,cssMode:E,stickyOffsetTop:N,zIndex:b}=t;return l({index:a,name:s,ownTop:i,setOwnTop:()=>{!o.value||(i.value=o.value.$el?o.value.$el.offsetTop:o.value.offsetTop)},setDisabled:k=>{d.value=k}}),{name:s,anchorEl:o,active:h,sticky:r,zIndex:b,disabled:d,cssMode:E,stickyOffsetTop:N,Transition:W}}});function Be(e,a,t,l,i,d){return _(),P(ee(e.sticky?"var-sticky":e.Transition),{"offset-top":e.sticky?e.stickyOffsetTop:null,"z-index":e.sticky?e.zIndex:null,disabled:e.disabled&&!e.cssMode,"css-mode":e.cssMode,ref:"anchorEl"},{default:y(()=>[j("div",Z({class:"var-index-anchor"},e.$attrs),[L(e.$slots,"default",{},()=>[T(v(e.name),1)])],16)]),_:3},8,["offset-top","z-index","disabled","css-mode"])}var Ee=z(Te,[["render",Be]]);const Ne={sticky:{type:Boolean,default:!0},stickyOffsetTop:{type:Number,default:0},cssMode:{type:Boolean,default:!1},hideList:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:1},highlightColor:{type:String},duration:{type:[Number,String],default:0},onClick:{type:Function},onChange:{type:Function}};const Ae=O({name:"VarIndexBar",props:Ne,setup(e){const{length:a,indexAnchors:t,bindIndexAnchors:l}=ke(),i=c(null),d=c(""),s=c(null),o=c(null),h=c([]),r=c(),E=x(()=>e.sticky),N=x(()=>e.cssMode),b=x(()=>e.stickyOffsetTop),A=x(()=>e.zIndex);l({active:r,sticky:E,cssMode:N,stickyOffsetTop:b,zIndex:A});const S=n=>{var f;const u=de(n)?n.name.value:n;u!==r.value&&(r.value=u,(f=e.onChange)==null||f.call(e,u))},k=()=>{const{scrollTop:n,scrollHeight:u}=i.value,{offsetTop:f}=o.value;t.forEach((m,p)=>{const I=m.ownTop.value,g=n-I+b.value-f,J=p===t.length-1?u:t[p+1].ownTop.value-m.ownTop.value;g>=0&&g<J&&!d.value&&(p&&!e.cssMode&&t[p-1].setDisabled(!0),m.setDisabled(!1),S(m))})},D=async(n,u)=>{var I;if(u&&((I=e.onClick)==null||I.call(e,n)),n===r.value)return;const f=t.find(({name:g})=>n===g.value);if(!f)return;const m=f.ownTop.value,p=ve(i.value);d.value=n,S(n),await fe(i.value,{left:p,top:m,animation:ce,duration:X(e.duration)}),_e(()=>{d.value=""})},G=n=>{he(()=>D(n,!0))};return ne(()=>a.value,()=>ae(()=>{t.forEach(({name:n,setOwnTop:u})=>{n.value&&h.value.push(n.value),u()})})),V(()=>{var n;s.value=ue(o.value),i.value=s.value===window?s.value.document.documentElement:s.value,(n=s.value)==null||n.addEventListener("scroll",k)}),te(()=>{var n;(n=s.value)==null||n.removeEventListener("scroll",k)}),{barEl:o,active:r,zIndex:A,anchorNameList:h,toNumber:X,scrollTo:G,anchorClick:D}}}),Se={class:"var-index-bar",ref:"barEl"},$e=["onClick"];function we(e,a,t,l,i,d){return _(),C("div",Se,[L(e.$slots,"default"),j("ul",{class:"var-index-bar__anchor-list",style:U({zIndex:e.toNumber(e.zIndex)+2,display:e.hideList?"none":"block"})},[(_(!0),C(M,null,R(e.anchorNameList,s=>(_(),C("li",{key:s,class:se(["var-index-bar__anchor-item",{"var-index-bar__anchor-item--active":e.active===s}]),style:U({color:e.active===s&&e.highlightColor?e.highlightColor:""}),onClick:o=>e.anchorClick(s)},v(s),15,$e))),128))],4)],512)}var B=z(Ae,[["render",we]]);B.install=function(e){e.component(B.name,B)};var ze={title:"\u6807\u9898",text:"\u6587\u672C"},De={title:"Title",text:"Text"};const{add:K,use:Oe,pack:Pe,packs:Ge,merge:Je}=pe(),je=e=>{Ce(e),Oe(e)};F("zh-CN",xe);F("en-US",ye);K("zh-CN",ze);K("en-US",De);const Le={name:"IndexBarExample",components:{VarIndexBar:B,VarIndexAnchor:Ee,VarCell:me},setup(){const e=c([]);V(()=>{for(let t=0;t<26;t++)e.value.push(String.fromCharCode(65+t))});const a=t=>{console.log(t)};return be(je),{list:e,pack:Pe,change:a}}};function Ve(e,a,t,l,i,d){const s=$("var-index-anchor"),o=$("var-cell"),h=$("var-index-bar");return _(),P(h,{onChange:l.change,duration:"300","sticky-offset-top":54},{default:y(()=>[(_(!0),C(M,null,R(l.list,r=>(_(),C("div",{key:r},[w(s,{index:r,class:"var-index-anchor__example"},{default:y(()=>[T(v(l.pack.title)+" "+v(r),1)]),_:2},1032,["index"]),w(o,null,{default:y(()=>[T(v(r)+" "+v(l.pack.text),1)]),_:2},1024),w(o,null,{default:y(()=>[T(v(r)+" "+v(l.pack.text),1)]),_:2},1024)]))),128))]),_:1},8,["onChange"])}var Qe=z(Le,[["render",Ve]]);export{Qe as default};
